<div
  class="group relative flex flex-col h-full !bg-gray-800/80 !backdrop-blur-md !border !border-gray-700 rounded-2xl p-4 shadow-xl hover:shadow-2xl hover:!border-blue-500/50 hover:-translate-y-1 transition-all duration-300 cursor-pointer overflow-hidden"
  (click)="navigateToProductDetails()">

  <!-- Decorative Top Glow -->
  <div
    class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
  </div>

  <!-- Remove Button (Top Right) -->
  <button (click)="onRemove(); $event.stopPropagation()"
    class="absolute top-3 right-3 w-9 h-9 bg-gray-900/80 text-gray-400 hover:text-red-400 border border-gray-600 hover:border-red-500/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all shadow-lg z-20"
    title="Remove from wishlist">
    <span class="material-icons text-lg">close</span>
  </button>

  <!-- Thumbnail -->
  <div
    class="relative mb-4 overflow-hidden rounded-xl bg-white p-2 h-48 flex items-center justify-center group-hover:shadow-inner transition-all">
    <img [src]="item.thumbnailUrl"
      class="max-w-full max-h-full object-contain group-hover:scale-105 transition-transform duration-500"
      [alt]="item.productTitle" />

    <!-- Wishlist Badge -->
    <div
      class="absolute top-2 left-2 bg-pink-500/90 backdrop-blur-sm text-white px-2.5 py-1 rounded-lg text-xs font-bold uppercase tracking-wider flex items-center gap-1 shadow-md z-10">
      <span class="material-icons text-[14px]">favorite</span>
      Saved
    </div>
  </div>

  <!-- Content -->
  <div class="flex flex-col flex-1 space-y-3">
    <!-- Title -->
    <h3
      class="font-bold text-gray-100 text-lg leading-snug line-clamp-2 min-h-[3.5rem] group-hover:text-blue-400 transition-colors">
      {{ item.productTitle }}
    </h3>

    <!-- Price -->
    <p class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400">
      {{ item.price | currency }}
    </p>

    <!-- Spacer to push buttons to bottom -->
    <div class="flex-1"></div>

    <!-- Action Buttons -->
    <div class="pt-2 mt-auto">
      <!-- If not in cart → show Add button -->
      @if (!cartItem()) {
      <button
        class="w-full h-12 bg-gray-700/50 hover:bg-blue-600 hover:text-white border border-gray-600 hover:border-blue-500 text-blue-400 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2 group/btn"
        (click)="addToCart(); $event.stopPropagation()">
        <span class="material-icons text-xl group-hover/btn:scale-110 transition-transform">shopping_cart</span>
        Add to Cart
      </button>
      }

      <!-- If in cart → show quantity controls -->
      @if (cartItem()) {
      <div
        class="flex items-center justify-between bg-gray-900/50 border border-green-500/30 rounded-xl px-2 py-1.5 h-12 w-full"
        (click)="$event.stopPropagation()">

        <button (click)="decrement(); $event.stopPropagation()"
          class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-red-400 hover:bg-gray-800 rounded-lg transition-colors">
          <span class="material-icons text-lg">remove</span>
        </button>

        <div class="flex flex-col items-center leading-none">
          <span class="text-[10px] text-green-400 font-bold uppercase tracking-widest mb-0.5">In Cart</span>
          <span class="text-lg font-bold text-white">{{ cartItem()!.quantity }}</span>
        </div>

        <button (click)="increment(); $event.stopPropagation()"
          class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-green-400 hover:bg-gray-800 rounded-lg transition-colors">
          <span class="material-icons text-lg">add</span>
        </button>
      </div>
      }
    </div>
  </div>
</div>